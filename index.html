<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<title>Nutty's nutty adventure</title>
		<style>
			body {
			  margin: 0;
              overflow: hidden;
            }

            .ui {
                color: white;
                text-shadow:
                -1px -1px 0 #000,
                1px -1px 0 #000,
                -1px 1px 0 #000,
                1px 1px 0 #000;  
                position: absolute;
            }

            button{
              margin: 20px;
            }
            
            .title_screen {
              vertical-align: middle;
              position: absolute;
            }
            
            .no_selection {
                -webkit-touch-callout:none;
                -webkit-user-select:none;
                -khtml-user-select:none;
                -moz-user-select:none;
                -ms-user-select:none;
                user-select:none;
                -webkit-tap-highlight-color:rgba(0,0,0,0);
            }
            
            .arrows {
                position: absolute;
            }
		</style>
	</head>
	<body class="no_selection">
		<!--script src="node_modules/three/build/three.js"></script-->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r127/three.js"></script>
		<script src="https://unpkg.com/three@0.127.0/examples/js/loaders/GLTFLoader.js"></script>
		<script>
		    var muted = false;
		    var score_submitted = false;
            function mute(){
                muted = !muted;
                console.log("button clicked!", muted);
                console.log(document.getElementById("sound_button").innerHTML.src);
                if (muted){
                    document.getElementById("sound_button").innerHTML = '<img src="images/music_off.png">';
                }else{
                    document.getElementById("sound_button").innerHTML = '<img src="images/music_on.png">';
                }
                document.getElementById("sound_button").blur()
            }
            /*var hint_number = 0;
            function hint(){
                document.getElementById("hint_button").innerHTML = [
                    "Nutty is hungry, go get some nuts!",
                    "Nutty has a good sense of smell...",
                    "Maybe nutty will show you the way",
                    "If nutty gets a rest, he might be able to smell the nuts"
                ][hint_number]
                document.getElementById("hint_button").blur()
            }
            */
            var gold_multiplyer = 10;
        </script>
        <script src="js/mysrc.js" type="module"></script>
        <button style="top:0; border:0px solid black; background-color: transparent;" id="sound_button" class="ui" onclick="mute()" hidden><img src="images/music_on.png"></button>
        <!--button style="top:90%; border:0px solid black; background-color: transparent; font-size:50px; color:white;" id="hint_button" class="ui" onclick="hint()" hidden>Hint</button-->
        <p style="top:90%; border:0px solid black; background-color: transparent; font-size:7px; color:white;" id="debug_p" class="ui"></p>
        <p style="right:0; padding: 30px; border:0px solid black; color: brown; font-size:30px; background-color: transparent;" id="acorn_count" class="ui" hidden>0</p>
        <p style="right:0; padding: 30px; border:0px solid black; color: yellow; font-size:30px; background-color: transparent; padding-top: 0%;" id="golden_acorn_count" class="ui" hidden>0</p>
        <div style="right:2%; bottom:2%; border:1px solid black; background-color: green; width:50%; height:1%" class="ui" id="health_bar" hidden></div>
        <!--p style="right:0; bottom:0; padding: 30px; border:0px solid black; color: white; font-size:30px; background-color: transparent;" id="clock" class="ui" hidden>frames left</p-->
        <img src="images/loading_screen.svg" height="100%" width="100%" class="title_screen" id="loading_screen" style="background-color: transparent;">
        <img src="images/title_screen.svg" height="100%" width="100%" class="title_screen" id="title_screen" style="background-color: transparent;" hidden>
        <img src="images/win_screen.svg" height="100%" width="100%" class="title_screen" id="win_screen" style="background-color: transparent;" hidden>
        <div syle="right:5%; height:100%; width:20%;" id="scoreboard" class="ui">
            <p id="scoreboard_text" style="color: white; font-size:30px; background-color: transparent; padding-top: 80%;">
            
            </p>
        </div>
        <div class="arrows" style="
            right:0; bottom:0;
            border-left: 100px solid transparent;
            border-right: 100px solid transparent;
            border-bottom: 100px solid black;
            border-top: 100px solid black;
            opacity: 0.2;
        " id="move_arrows">
        </div>
        <div class="arrows" style="
            left:0; bottom:0;
            border-left: 100px solid transparent;
            border-right: 100px solid transparent;
            border-bottom: 100px solid black;
            border-top: 100px solid black;
            opacity: 0.2;
        " id="cam_arrows">
        </div>
        <div style="width:100%; height:100%; position:absolute; text-align:center;" hidden id="score_div">
            <div class="ui" style= "top: 70%; left: 45%">
                <p id="score_paragraph">hello hello hello</p>
                <input type="text" name= "Enter your name" id="name_box" style= "opacity: 0.4;" value="" placeholder="gamer name">
                <button onclick="submit_score()">Submit Score</button>
            </div>
        </div>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
        <script>
            function reset_touch_feedback(){
                document.getElementById("move_arrows").style.borderLeft = window.innerWidth/4 + "px solid transparent";
                document.getElementById("move_arrows").style.borderRight = window.innerWidth/4 + "px solid transparent";
                document.getElementById("move_arrows").style.borderTop = window.innerHeight/4 + "px solid transparent";
                document.getElementById("move_arrows").style.borderBottom = window.innerHeight/4 + "px solid transparent";
                
                document.getElementById("cam_arrows").style.borderLeft = window.innerWidth/4 + "px solid transparent";
                document.getElementById("cam_arrows").style.borderRight = window.innerWidth/4 + "px solid transparent";
                document.getElementById("cam_arrows").style.borderTop = window.innerHeight/4 + "px solid transparent";
                document.getElementById("cam_arrows").style.borderBottom = window.innerHeight/4 + "px solid transparent";
            }
            reset_touch_feedback();

            console.log("sizes right??", window.innerWidth / 4);
            function fill_scoreboard(e) {
                var s = "";
                for (var i = 0; i < e.length; ++i){
                    s += "  " + e[i] + "<br>"                 
                }
                document.getElementById("scoreboard_text").innerHTML = s;
            }
            function submit_score(){
                const name = document.getElementById("name_box").value;
                const score = (
                    parseInt(document.getElementById("acorn_count").innerHTML) + 
                    parseInt(document.getElementById("golden_acorn_count").innerHTML) * gold_multiplyer
                );
                const url_base = "https://script.google.com/macros/s/AKfycbzBR5szqeZhBFi8nYUkribLnv4XCFMIX_q3DfANMeuL7b7p8em5f2dvy9nLl5kSUfeB/exec";
                var url = url_base + "?user=" + name + "&score=" + score +"&callback=fill_scoreboard";

                // Make an AJAX call to Google Script
                jQuery.ajax({
                    crossDomain: true,
                    url: url,
                    method: "GET",
                    dataType: "jsonp"
                });
                
                document.getElementById("score_div").style.display = 'none';
                document.getElementById("win_screen").style.display = 'none';
                score_submitted = true;
            }
        </script>

	</body>
</html>
